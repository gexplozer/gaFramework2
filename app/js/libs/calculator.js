const modalCalc=new tingle.modal({cssClass:["modalCalc"],onOpen:function(){common.formsListener(".tingle-modal .leadData")}});let pattern=/(?=\B(?:\d{3})+(?!\d))/g;function changePrice(t){t.preventDefault(),modalCalc.setContent(qS(".calculatorCta").innerHTML),qS(".modalCalc .calculatedPrice span").innerHTML=this.dataset.price?this.dataset.price:"0",modalCalc.open()}let common=sendData(modalCalc);function Calculator(t,e){this.counted=(a=>{let n=Math.round(a);qS(".calculatorCta .discountAlert").innerHTML=n>299?"Внимание! На объёмы от 300 кг возможны скидки! Оставляйте заявку!":"",qS(`${t} .counted`).innerHTML=`${n} кг`;let i=n*e;qS(`${t} .getPrice`).dataset.price=i.toString().replace(pattern," ")}),fClick(`${t} .getPrice`,changePrice)}const calcAdmix=new Calculator(".calcAdmix",330),calcPenetron=new Calculator(".calcPenetron",330),calcPenecrete=new Calculator(".calcPenecrete",285);let calcElem=qS(".calcForest");if(calcElem){function calcForest(){let t=new FormData(calcElem),e={};function a(t){return(0^t)===t}["height","width","lestnica","nastil","doubleHorizont"].forEach(a=>{e[a]=t.get(a)}),a(e.height/2)||e.height++,a(e.width/3)||e.width++,a(e.width/3)||e.width++;let n=e.height/2,i=e.width/3;e.lestnica>i&&(e.lestnica=i),e.nastil>n&&(e.nastil=n),e.doubleHorizont?d2h=2:d2h=1;let c={pyatki:t.get("isPyata")?2*i+2:0,diagonal:i*n,balka:2*i*n,nastil:3*i*e.nastil,ramaSLestnicey:n*e.lestnica};c.horizontal=c.diagonal*d2h,c.ramaBezListnicy=(2*i+2)/2*n-c.ramaSLestnicey,qS("#forestResults div").innerHTML=`\n\t\t\t<h3>Нужное количество:</h3>\n\t\t\t<p>Рама с лестницей: ${c.ramaSLestnicey}\n\t\t\t<p>Рама проходная: ${c.ramaBezListnicy}\n\t\t\t<p>Горизонтали: ${c.horizontal}\n\t\t\t<p>Диагонали: ${c.diagonal}\n\t\t\t<p>Балка настила: ${c.balka}\n\t\t\t<p>Щиты настила: ${c.nastil}\n\t\t\t<p>Опорная пята: ${c.pyatki}`,qS("#scheme").innerHTML="";for(let t=0;t<c.diagonal;t++){let t=document.createElement("img");t.setAttribute("src","/img/forest.png"),t.style.width=`${100/i}%`,qS("#scheme").appendChild(t)}let l=c.ramaSLestnicey*t.get("lestPrice")+c.ramaBezListnicy*t.get("prohodPrice")+c.horizontal*t.get("horizPrice")+c.diagonal*t.get("diagPrice")+c.balka*t.get("balkaPrice")+c.nastil*t.get("nastilPrice")+c.pyatki*t.get("pyataPrice");qS(".calcForest .getPrice").dataset.price=l.toString().replace(pattern," "),qS("#priceResults").innerHTML=`\n\t\t\t<h3>Стоимость:</h3>\n\t\t\t<p>Рама с лестницей: ${c.ramaSLestnicey*t.get("lestPrice")}\n\t\t\t<p>Рама проходная: ${c.ramaBezListnicy*t.get("prohodPrice")}\n\t\t\t<p>Горизонтали: ${c.horizontal*t.get("horizPrice")}\n\t\t\t<p>Диагонали: ${c.diagonal*t.get("diagPrice")}\n\t\t\t<p>Балка настила: ${c.balka*t.get("balkaPrice")}\n\t\t\t<p>Щиты настила: ${c.nastil*t.get("nastilPrice")}\n\t\t\t<p>Опорная пята: ${c.pyatki*t.get("pyataPrice")}\n\t\t\t<p><strong>Всего</strong>: ${l.toString().replace(pattern," ")} рублей`}["click","keyup","change"].forEach(t=>{calcElem.addEventListener(t,calcForest)}),fClick(".calcForest .getPrice",changePrice)}